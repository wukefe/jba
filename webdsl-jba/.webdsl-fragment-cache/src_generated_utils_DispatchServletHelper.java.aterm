("9.7pre",["src-generated/utils/DispatchServletHelper.java"],JavaFile(["src-generated"],CompilationUnit(Some(PackageDec([],PackageName([Id("utils")]))),[TypeImportOnDemandDec(PackageName([Id("java"),Id("io")])),TypeImportDec(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("HashMap"))),TypeImportDec(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("Map"))),TypeImportDec(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("List"))),TypeImportDec(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("LinkedList"))),TypeImportDec(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("ArrayList"))),TypeImportDec(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("TimeZone"))),TypeImportDec(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("text")),Id("SimpleDateFormat"))),TypeImportDec(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("text")),Id("DateFormat"))),TypeImportDec(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("Date"))),TypeImportOnDemandDec(PackageName([Id("javax"),Id("servlet")])),TypeImportOnDemandDec(PackageName([Id("javax"),Id("servlet"),Id("http")])),TypeImportOnDemandDec(PackageName([Id("utils")])),TypeImportOnDemandDec(PackageName([Id("webdsl"),Id("generated"),Id("templates")])),TypeImportDec(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("webdsl")),Id("lang")),Id("Environment"))),TypeImportDec(TypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("webdsl")),Id("WebDSLEntity"))),TypeImportDec(TypeName(PackageName([Id("webdsl"),Id("generated"),Id("domain")]),Id("RequestLogEntry"))),TypeImportDec(TypeName(PackageName([Id("webdsl"),Id("generated"),Id("domain")]),Id("SessionManager")))],[ClassDec(ClassDecHead([SingleElemAnno(TypeName(Id("SuppressWarnings")),ElemValArrayInit([Lit(String([Chars("unused")])),Lit(String([Chars("unchecked")])),Lit(String([Chars("rawtypes")]))])),Public],Id("DispatchServletHelper"),None,Some(SuperDec(ClassType(TypeName(Id("AbstractDispatchServletHelper")),None))),None),ClassBody([StaticInit(Block([ExprStm(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("EntityReflectionHelper")),Id("init"))),[]))])),FieldDec([],ClassOrInterfaceType(TypeName(PackageName([Id("webdsl"),Id("generated"),Id("domain")]),Id("SessionManager")),None),[VarDec(Id("sessionManager"),Lit(Null))]),MethodDec(MethodDecHead([Public],None,ClassOrInterfaceType(TypeName(PackageName([Id("webdsl"),Id("generated"),Id("domain")]),Id("SessionManager")),None),Id("getSessionManager"),[],None),Block([Return(Some(ExprName(Id("sessionManager"))))])),MethodDec(MethodDecHead([Public],None,Boolean,Id("sessionHasChanges"),[],None),Block([Return(Some(LazyAnd(NotEq(Invoke(Method(Invoke(Method(MethodName(Id("getSessionManager"))),[]),None,Id("getSessionHasChanges")),[]),Lit(Null)),Invoke(Method(Invoke(Method(MethodName(Id("getSessionManager"))),[]),None,Id("getSessionHasChanges")),[]))))])),MethodDec(MethodDecHead([Public],None,Void,Id("loadSessionManager"),[Param([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("hibernate")),Id("Session")),None),Id("hses"))],None),Block([ExprStm(Invoke(Method(MethodName(Id("loadSessionManager"))),[ExprName(Id("hses")),Lit(Null)]))])),MethodDec(MethodDecHead([Public],None,Void,Id("loadSessionManager"),[Param([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("hibernate")),Id("Session")),None),Id("hses")),Param([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),Id("joins"))],None),Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("basicCookieInfo"),Plus(Plus(Lit(String([Chars("WEBDSLSESSIONID=")])),Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("UUIDUserType")),Id("persistUUIDString"))),[ExprName(Id("sessionId"))])),Lit(String([Chars("; HttpOnly; path=/")]))))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("setCookie"),Lit(String([Chars("SET-COOKIE")])))])),ExprStm(Assign(ExprName(Id("sessionManager")),CastRef(ClassOrInterfaceType(TypeName(Id("SessionManager")),None),Invoke(Method(MethodName(AmbName(Id("hses")),Id("get"))),[Lit(Class(ClassOrInterfaceType(TypeName(Id("SessionManager")),None))),ExprName(Id("sessionId"))])))),If(Eq(ExprName(Id("sessionManager")),Lit(Null)),Block([ExprStm(Assign(ExprName(Id("sessionManager")),NewInstance(None,ClassOrInterfaceType(TypeName(Id("SessionManager")),None),[],None))),ExprStm(Invoke(Method(MethodName(AmbName(Id("sessionManager")),Id("setId"))),[ExprName(Id("sessionId"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("sessionManager")),Id("setLastUseNoEventsOrValidation"))),[NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("Date")),None),[],None)])),ExprStm(Invoke(Method(MethodName(AmbName(Id("sessionManager")),Id("setVersion"))),[Lit(Deci("1"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("sessionManager")),Id("setChanged"))),[])),ExprStm(Invoke(Method(MethodName(AmbName(Id("hses")),Id("save"))),[ExprName(Id("sessionManager"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("response")),Id("setHeader"))),[ExprName(Id("setCookie")),ExprName(Id("basicCookieInfo"))]))])),If(LazyAnd(NotEq(Invoke(Method(MethodName(AmbName(Id("sessionManager")),Id("getStayLoggedIn"))),[]),Lit(Null)),Invoke(Method(MethodName(AmbName(Id("sessionManager")),Id("getStayLoggedIn"))),[])),Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("Date")),None),[VarDec(Id("expdate"),Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("DateType")),Id("addMinutes"))),[NewInstance(None,ClassOrInterfaceType(TypeName(Id("Date")),None),[],None),Lit(Deci("10000"))]))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("DateFormat")),None),[VarDec(Id("df"),NewInstance(None,ClassOrInterfaceType(TypeName(Id("SimpleDateFormat")),None),[Lit(String([Chars("dd MMM yyyy kk:mm:ss z")]))],None))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("df")),Id("setTimeZone"))),[Invoke(Method(MethodName(AmbName(Id("TimeZone")),Id("getTimeZone"))),[Lit(String([Chars("GMT")]))])])),ExprStm(Invoke(Method(MethodName(AmbName(Id("response")),Id("setHeader"))),[ExprName(Id("setCookie")),Plus(Plus(ExprName(Id("basicCookieInfo")),Lit(String([Chars("; expires=")]))),Invoke(Method(MethodName(AmbName(Id("df")),Id("format"))),[ExprName(Id("expdate"))]))]))])),ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("webdsl")),Id("generated")),Id("functions")),Id("internalUpdateSessionManagerTimeout_")),Id("internalUpdateSessionManagerTimeout_"))),[]))])),MethodDec(MethodDecHead([Public],None,Void,Id("storeOutgoingMessagesInHttpSession"),[],None),Block([If(Gt(Invoke(Method(Invoke(Method(MethodName(AmbName(Id("sessionManager")),Id("getMessages"))),[]),None,Id("size")),[]),Lit(Deci("0"))),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("sessionManager")),Id("removeAllFromMessages"))),[]))])),If(Gt(Invoke(Method(MethodName(AmbName(Id("outgoingSuccessMessages")),Id("size"))),[]),Lit(Deci("0"))),Block([ForEach(Param([],ClassOrInterfaceType(TypeName(Id("String")),None),Id("s")),ExprName(Id("outgoingSuccessMessages")),Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageName([Id("webdsl"),Id("generated"),Id("domain")]),Id("SessionMessage")),None),[VarDec(Id("m"),Invoke(Method(MethodName(AmbName(PackageName([Id("webdsl"),Id("generated"),Id("domain")]),Id("SessionMessage")),Id("_static_createEmpty_"))),[]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("m")),Id("setVersion"))),[Lit(Deci("1"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("m")),Id("setTextNoEventsOrValidation"))),[ExprName(Id("s"))])),ExprStm(Invoke(Method(Invoke(Method(MethodName(AmbName(Id("sessionManager")),Id("getMessages"))),[]),None,Id("add")),[ExprName(Id("m"))]))]))]))])),MethodDec(MethodDecHead([Public],None,Void,Id("retrieveIncomingMessagesFromHttpSession"),[],None),Block([ForEach(Param([],ClassOrInterfaceType(TypeName(PackageName([Id("webdsl"),Id("generated"),Id("domain")]),Id("SessionMessage")),None),Id("m")),Invoke(Method(MethodName(AmbName(Id("sessionManager")),Id("getMessages"))),[]),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("incomingSuccessMessages")),Id("add"))),[Invoke(Method(MethodName(AmbName(Id("m")),Id("getText"))),[])]))]))])),FieldDec([],ClassOrInterfaceType(TypeName(Id("RequestLogEntry")),None),[VarDec(Id("requestLogEntry"),Lit(Null))]),MethodDec(MethodDecHead([Public],None,ClassOrInterfaceType(TypeName(Id("RequestLogEntry")),None),Id("getRequestLogEntry"),[],None),Block([Return(Some(ExprName(Id("requestLogEntry"))))])),StaticInit(Block([Try(Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("Properties")),None),[VarDec(Id("props"),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("Properties")),None),[],None))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("props")),Id("load"))),[Invoke(Method(Lit(Class(ClassOrInterfaceType(TypeName(Id("DispatchServletHelper")),None))),None,Id("getResourceAsStream")),[Lit(String([Chars("/tomcat.properties")]))])])),ExprStm(Assign(ExprName(Id("httpsPort")),Invoke(Method(MethodName(AmbName(Id("Integer")),Id("parseInt"))),[Invoke(Method(MethodName(AmbName(Id("props")),Id("getProperty"))),[Lit(String([Chars("webdsl.tomcat.https.port")]))])]))),ExprStm(Assign(ExprName(Id("httpPort")),Invoke(Method(MethodName(AmbName(Id("Integer")),Id("parseInt"))),[Invoke(Method(MethodName(AmbName(Id("props")),Id("getProperty"))),[Lit(String([Chars("webdsl.tomcat.http.port")]))])])))]),[Catch(Param([],ClassOrInterfaceType(TypeName(Id("Exception")),None),Id("ex")),Block([ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Lit(String([Chars("Could not read tomcat.properties file, custom http(s) port settings are ignored in the currently deployed application.")]))]))]))])])),FieldDec([],ClassOrInterfaceType(TypeName(Id("DispatchServlet")),None),[VarDec(Id("servlet"))]),ConstrDec(ConstrDecHead([Public],None,Id("DispatchServletHelper"),[Param([],ClassOrInterfaceType(TypeName(Id("DispatchServlet")),None),Id("servlet")),Param([],Boolean,Id("isPost")),Param([],ClassOrInterfaceType(TypeName(Id("String")),None),Id("contextPath"))],None),ConstrBody(None,[ExprStm(Assign(Field(This,Id("servlet")),ExprName(Id("servlet")))),ExprStm(Assign(Field(This,Id("isPostRequest")),ExprName(Id("isPost")))),ExprStm(Assign(Field(This,Id("contextPath")),ExprName(Id("contextPath"))))])),MethodDec(MethodDecHead([],None,ClassOrInterfaceType(TypeName(Id("DispatchServlet")),None),Id("getServlet"),[],None),Block([Return(Some(ExprName(Id("servlet"))))])),StaticInit(Block([Block([LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("s"),ArrayInit([Lit(String([Chars("admin")])),Lit(String([Chars("len")]))]))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("Boolean")),None)),[VarDec(Id("b"),ArrayInit([Lit(Bool(False)),Lit(Bool(False))]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pages")),Id("put"))),[ExprName(Id("\"table_content\"")),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[ExprName(Id("Table_contentPage.class")),ExprName(Id("s")),ExprName(Id("b")),Lit(Bool(False))],None)]))]),Block([LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("s"),ArrayInit([]))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("Boolean")),None)),[VarDec(Id("b"),ArrayInit([]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pages")),Id("put"))),[ExprName(Id("\"root\"")),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[ExprName(Id("RootPage.class")),ExprName(Id("s")),ExprName(Id("b")),Lit(Bool(False))],None)]))]),Block([LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("s"),ArrayInit([Lit(String([Chars("u")]))]))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("Boolean")),None)),[VarDec(Id("b"),ArrayInit([Lit(Bool(False))]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pages")),Id("put"))),[ExprName(Id("\"page_view\"")),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[ExprName(Id("Page_viewPage.class")),ExprName(Id("s")),ExprName(Id("b")),Lit(Bool(False))],None)]))]),Block([LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("s"),ArrayInit([]))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("Boolean")),None)),[VarDec(Id("b"),ArrayInit([]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pages")),Id("put"))),[ExprName(Id("\"page_login\"")),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[ExprName(Id("Page_loginPage.class")),ExprName(Id("s")),ExprName(Id("b")),Lit(Bool(False))],None)]))]),Block([LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("s"),ArrayInit([Lit(String([Chars("admin")]))]))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("Boolean")),None)),[VarDec(Id("b"),ArrayInit([Lit(Bool(False))]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pages")),Id("put"))),[ExprName(Id("\"page_admin_welcome\"")),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[ExprName(Id("Page_admin_welcomePage.class")),ExprName(Id("s")),ExprName(Id("b")),Lit(Bool(False))],None)]))]),Block([LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("s"),ArrayInit([Lit(String([Chars("admin")])),Lit(String([Chars("indx")]))]))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("Boolean")),None)),[VarDec(Id("b"),ArrayInit([Lit(Bool(False)),Lit(Bool(False))]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pages")),Id("put"))),[ExprName(Id("\"page_admin_index\"")),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[ExprName(Id("Page_admin_indexPage.class")),ExprName(Id("s")),ExprName(Id("b")),Lit(Bool(False))],None)]))]),Block([LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("s"),ArrayInit([Lit(String([Chars("admin")])),Lit(String([Chars("count")]))]))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("Boolean")),None)),[VarDec(Id("b"),ArrayInit([Lit(Bool(False)),Lit(Bool(False))]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pages")),Id("put"))),[ExprName(Id("\"page_admin_edit\"")),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[ExprName(Id("Page_admin_editPage.class")),ExprName(Id("s")),ExprName(Id("b")),Lit(Bool(False))],None)]))]),Block([LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("s"),ArrayInit([]))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("Boolean")),None)),[VarDec(Id("b"),ArrayInit([]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pages")),Id("put"))),[ExprName(Id("\"page_about\"")),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[ExprName(Id("Page_aboutPage.class")),ExprName(Id("s")),ExprName(Id("b")),Lit(Bool(False))],None)]))]),Block([LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("s"),ArrayInit([]))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("Boolean")),None)),[VarDec(Id("b"),ArrayInit([]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pages")),Id("put"))),[ExprName(Id("\"pagenotfound\"")),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[ExprName(Id("PagenotfoundPage.class")),ExprName(Id("s")),ExprName(Id("b")),Lit(Bool(False))],None)]))]),Block([LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("s"),ArrayInit([]))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("Boolean")),None)),[VarDec(Id("b"),ArrayInit([]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pages")),Id("put"))),[ExprName(Id("\"accessDenied\"")),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[ExprName(Id("AccessDeniedPage.class")),ExprName(Id("s")),ExprName(Id("b")),Lit(Bool(False))],None)]))]),Block([LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("s"),ArrayInit([Lit(String([Chars("list")]))]))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("Boolean")),None)),[VarDec(Id("b"),ArrayInit([Lit(Bool(False))]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pages")),Id("put"))),[ExprName(Id("\"showMessagesList_String_\"")),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[ExprName(Id("ShowMessagesList_String_Page.class")),ExprName(Id("s")),ExprName(Id("b")),Lit(Bool(True))],None)]))]),Block([LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("s"),ArrayInit([]))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("Boolean")),None)),[VarDec(Id("b"),ArrayInit([]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pages")),Id("put"))),[ExprName(Id("\"noMessages\"")),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[ExprName(Id("NoMessagesPage.class")),ExprName(Id("s")),ExprName(Id("b")),Lit(Bool(True))],None)]))])])),MethodDec(MethodDecHead([Public],None,Void,Id("storeRequestLogEntry"),[Param([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("hibernate")),Id("Session")),None),Id("hibSession"))],None),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("hibSession")),Id("saveOrUpdate"))),[ExprName(Id("requestLogEntry"))]))])),MethodDec(MethodDecHead([Public],None,Void,Id("setEndTimeAndStoreRequestLog"),[Param([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("hibernate")),Id("Session")),None),Id("hibSession"))],None),Block([If(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("BuildProperties")),Id("isRequestLoggingEnabled"))),[]),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("requestLogEntry")),Id("setEndNoEventsOrValidation"))),[NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("Date")),None),[],None)])),ExprStm(Invoke(Method(MethodName(Id("storeRequestLogEntry"))),[ExprName(Id("hibSession"))]))]))])),MethodDec(MethodDecHead([Public],None,Void,Id("doServe"),[Param([],ClassOrInterfaceType(TypeName(Id("HttpServletRequest")),None),Id("request")),Param([],ClassOrInterfaceType(TypeName(Id("HttpServletResponse")),None),Id("response"))],Some(ThrowsDec([ClassType(TypeName(Id("IOException")),None),ClassType(TypeName(Id("ServletException")),None)]))),Block([ExprStm(Assign(ExprName(Id("requestLogEntry")),Invoke(Method(MethodName(AmbName(Id("RequestLogEntry")),Id("_static_createEmpty_"))),[]))),ExprStm(Invoke(Method(MethodName(AmbName(Id("requestLogEntry")),Id("setStartNoEventsOrValidation"))),[NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("Date")),None),[],None)])),If(NotEq(Invoke(Method(MethodName(AmbName(Id("request")),Id("getCookies"))),[]),Lit(Null)),Block([ForEach(Param([],ClassOrInterfaceType(TypeName(Id("Cookie")),None),Id("c")),Invoke(Method(MethodName(AmbName(Id("request")),Id("getCookies"))),[]),Block([If(Invoke(Method(Lit(String([Chars("WEBDSLSESSIONID")])),None,Id("equals")),[Invoke(Method(MethodName(AmbName(Id("c")),Id("getName"))),[])]),Block([Try(Block([ExprStm(Assign(ExprName(Id("sessionId")),Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("UUIDUserType")),Id("retrieveUUID"))),[Invoke(Method(MethodName(AmbName(Id("c")),Id("getValue"))),[])])))]),[Catch(Param([],ClassOrInterfaceType(TypeName(Id("Exception")),None),Id("ex")),Block([ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Lit(String([Chars("Could not create UUID from String, new session will be created")]))]))]))])]))]))])),If(Eq(ExprName(Id("sessionId")),Lit(Null)),Block([ExprStm(Assign(ExprName(Id("sessionId")),Invoke(Method(MethodName(AmbName(AmbName(AmbName(Id("java")),Id("util")),Id("UUID")),Id("randomUUID"))),[])))])),ExprStm(Assign(Field(This,Id("request")),ExprName(Id("request")))),ExprStm(Assign(Field(This,Id("response")),ExprName(Id("response")))),ExprStm(Invoke(Method(MethodName(AmbName(Id("response")),Id("setCharacterEncoding"))),[Lit(String([Chars("UTF-8")]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("ThreadLocalServlet")),Id("set"))),[This])),LocalVarDecStm(LocalVarDec([],Boolean,[VarDec(Id("showerrorpage"),Lit(Bool(False)))])),LocalVarDecStm(LocalVarDec([],Boolean,[VarDec(Id("showvalidationerror"),Lit(Bool(False)))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("MultipleValidationExceptions")),None),[VarDec(Id("validationExceptions"),Lit(Null))])),Try(Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("url"),Invoke(Method(Invoke(Method(MethodName(AmbName(Id("request")),Id("getRequestURL"))),[]),None,Id("toString")),[]))])),ExprStm(Assign(Field(This,Id("baseUrl")),Plus(Plus(Invoke(Method(MethodName(AmbName(Id("url")),Id("substring"))),[Lit(Deci("0")),Minus(Invoke(Method(MethodName(AmbName(Id("url")),Id("length"))),[]),Invoke(Method(Invoke(Method(MethodName(AmbName(Id("request")),Id("getRequestURI"))),[]),None,Id("length")),[]))]),Invoke(Method(MethodName(AmbName(Id("request")),Id("getContextPath"))),[])),Lit(String([Chars("/")]))))),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("req"),Invoke(Method(MethodName(AmbName(Id("url")),Id("split"))),[Lit(String([Chars("/")]))]))])),LocalVarDecStm(LocalVarDec([],Int,[VarDec(Id("count"))])),LocalVarDecStm(LocalVarDec([],Boolean,[VarDec(Id("first"),Lit(Bool(False)))])),If(Gt(Invoke(Method(Invoke(Method(MethodName(AmbName(Id("ThreadLocalServlet")),Id("getContextPath"))),[]),None,Id("length")),[]),Lit(Deci("1"))),Block([For([Assign(ExprName(Id("count")),Lit(Deci("0")))],Some(Lt(ExprName(Id("count")),ExprName(AmbName(Id("req")),Id("length")))),[PostIncr(ExprName(Id("count")))],Block([If(Invoke(Method(ArrayAccess(ExprName(Id("req")),ExprName(Id("count"))),None,Id("equals")),[Lit(String([Chars("web-dsl-simple")]))]),Block([ExprStm(PostIncr(ExprName(Id("count")))),Break(None)]))]))]),Block([ExprStm(Assign(ExprName(Id("count")),Lit(Deci("3"))))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("argnames"))])),LocalVarDecStm(LocalVarDec([],ArrayType(ClassOrInterfaceType(TypeName(Id("String")),None)),[VarDec(Id("args"))])),ExprStm(Assign(ExprName(Id("urlComponents")),NewInstance(None,ClassOrInterfaceType(TypeName(Id("ArrayList")),Some(TypeArgs([ClassOrInterfaceType(TypeName(Id("String")),None)]))),[],None))),If(Gt(ExprName(Id("count")),Minus(ExprName(AmbName(Id("req")),Id("length")),Lit(Deci("1")))),Block([ExprStm(Assign(ExprName(Id("requested")),Lit(String([Chars("root")])))),ExprStm(Assign(ExprName(Id("args")),NewArray(TypeName(Id("String")),[Dim(Lit(Deci("0")))],[]))),ExprStm(Invoke(Method(MethodName(AmbName(Id("urlComponents")),Id("add"))),[Lit(String([Chars("root")]))]))]),Block([ExprStm(Assign(ExprName(Id("requested")),ArrayAccess(ExprName(Id("req")),ExprName(Id("count"))))),ExprStm(Assign(ExprName(Id("args")),Invoke(Method(MethodName(AmbName(AmbName(AmbName(Id("java")),Id("util")),Id("Arrays")),Id("copyOfRange"))),[ExprName(Id("req")),Plus(ExprName(Id("count")),Lit(Deci("1"))),ExprName(AmbName(Id("req")),Id("length"))]))),ExprStm(Invoke(Method(MethodName(AmbName(Id("urlComponents")),Id("add"))),[ExprName(Id("requested"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("urlComponents")),Id("addAll"))),[Invoke(Method(MethodName(AmbName(AmbName(AmbName(Id("java")),Id("util")),Id("Arrays")),Id("asList"))),[ExprName(Id("args"))])]))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("List")),Some(TypeArgs([ClassOrInterfaceType(TypeName(Id("String")),None)]))),[VarDec(Id("customRoutingList"),Invoke(Method(MethodName(AmbName(Id("Routing")),Id("processRequest"))),[ExprName(Id("urlComponents"))]))])),If(NotEq(ExprName(Id("customRoutingList")),Lit(Null)),Block([ExprStm(Assign(ExprName(Id("requested")),Invoke(Method(MethodName(AmbName(Id("customRoutingList")),Id("get"))),[Lit(Deci("0"))]))),ExprStm(Invoke(Method(MethodName(AmbName(Id("customRoutingList")),Id("remove"))),[Lit(Deci("0"))])),ExprStm(Assign(ExprName(Id("args")),NewArray(TypeName(Id("String")),[Dim(Invoke(Method(MethodName(AmbName(Id("customRoutingList")),Id("size"))),[]))],[]))),ExprStm(Invoke(Method(MethodName(AmbName(Id("customRoutingList")),Id("toArray"))),[ExprName(Id("args"))]))])),ExprStm(Assign(ExprName(Id("fileUploads")),NewInstance(None,ClassOrInterfaceType(TypeName(Id("HashMap")),Some(TypeArgs([ClassOrInterfaceType(TypeName(Id("String")),None),ClassOrInterfaceType(TypeName(Id("List")),Some(TypeArgs([ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("File")),None)])))]))),[],None))),ExprStm(Assign(ExprName(Id("parammap")),NewInstance(None,ClassOrInterfaceType(TypeName(Id("HashMap")),Some(TypeArgs([ClassOrInterfaceType(TypeName(Id("String")),None),ClassOrInterfaceType(TypeName(Id("String")),None)]))),[],None))),ExprStm(Assign(ExprName(Id("parammapvalues")),NewInstance(None,ClassOrInterfaceType(TypeName(Id("HashMap")),Some(TypeArgs([ClassOrInterfaceType(TypeName(Id("String")),None),ClassOrInterfaceType(TypeName(Id("List")),Some(TypeArgs([ClassOrInterfaceType(TypeName(Id("String")),None)])))]))),[],None))),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("PageDispatch")),None),[VarDec(Id("pd"),Invoke(Method(MethodName(AmbName(Id("pages")),Id("get"))),[ExprName(Id("requested"))]))])),If(Eq(ExprName(Id("pd")),Lit(Null)),Block([ExprStm(Assign(ExprName(Id("requested")),Lit(String([Chars("pagenotfound")])))),ExprStm(Assign(ExprName(Id("pd")),Invoke(Method(MethodName(AmbName(Id("pages")),Id("get"))),[ExprName(Id("requested"))]))),ExprStm(Assign(ExprName(Id("pc")),Invoke(Method(MethodName(AmbName(Id("pd")),Id("getPageClass"))),[])))]),Block([ExprStm(Assign(ExprName(Id("pc")),Invoke(Method(MethodName(AmbName(Id("pd")),Id("getPageClass"))),[])))])),ExprStm(Assign(ExprName(Id("argnames")),Invoke(Method(Invoke(Method(MethodName(AmbName(Id("pages")),Id("get"))),[ExprName(Id("requested"))]),None,Id("getArgs")),[]))),LocalVarDecStm(LocalVarDec([],Int,[VarDec(Id("count2"),Lit(Deci("0")))])),For([Assign(ExprName(Id("count2")),Lit(Deci("0")))],Some(Lt(ExprName(Id("count2")),ExprName(AmbName(Id("args")),Id("length")))),[PostIncr(ExprName(Id("count2")))],Block([If(GtEq(ExprName(Id("count2")),ExprName(AmbName(Id("argnames")),Id("length"))),Block([]),Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("decoded"),Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("URLFilter")),Id("unfilter"))),[ArrayAccess(ExprName(Id("args")),ExprName(Id("count2")))]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("parammap")),Id("put"))),[ArrayAccess(ExprName(Id("argnames")),ExprName(Id("count2"))),ExprName(Id("decoded"))])),ExprStm(Invoke(Method(MethodName(Id("addToValues"))),[ArrayAccess(ExprName(Id("argnames")),ExprName(Id("count2"))),ExprName(Id("decoded")),ExprName(Id("parammapvalues"))]))]))])),For(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("Enumeration")),None),[VarDec(Id("en"),Invoke(Method(MethodName(AmbName(Id("request")),Id("getParameterNames"))),[]))]),Some(Invoke(Method(MethodName(AmbName(Id("en")),Id("hasMoreElements"))),[])),[],Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("parameterName"),CastRef(ClassOrInterfaceType(TypeName(Id("String")),None),Invoke(Method(MethodName(AmbName(Id("en")),Id("nextElement"))),[])))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("parammap")),Id("put"))),[ExprName(Id("parameterName")),Invoke(Method(MethodName(Id("paramDecode"))),[ExprName(Id("request")),Invoke(Method(MethodName(AmbName(Id("request")),Id("getParameter"))),[ExprName(Id("parameterName"))])])])),ForEach(Param([],ClassOrInterfaceType(TypeName(Id("String")),None),Id("paramval")),Invoke(Method(MethodName(AmbName(Id("request")),Id("getParameterValues"))),[ExprName(Id("parameterName"))]),Block([ExprStm(Invoke(Method(MethodName(Id("addToValues"))),[ExprName(Id("parameterName")),Invoke(Method(MethodName(Id("paramDecode"))),[ExprName(Id("request")),ExprName(Id("paramval"))]),ExprName(Id("parammapvalues"))]))]))])),If(Lt(ExprName(Id("count2")),ExprName(AmbName(Id("argnames")),Id("length"))),Block([If(LazyAnd(Not(ExprName(Id("isPostRequest"))),Eq(Invoke(Method(MethodName(AmbName(Id("parammap")),Id("get"))),[Lit(String([Chars("action-call-with-get-request-type")]))]),Lit(Null))),Block([If(Invoke(Method(MethodName(Id("unspecifiedArgumentsContainEntityTypes"))),[ExprName(Id("argnames")),ExprName(Id("count2"))]),Block([Throw(NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("TooFewArgumentsException")),None),[],None))]))]))])),LocalVarDecStm(LocalVarDec([],Boolean,[VarDec(Id("isMultipart"),Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("apache")),Id("commons")),Id("fileupload")),Id("servlet")),Id("ServletFileUpload")),Id("isMultipartContent"))),[ExprName(Id("request"))]))])),If(ExprName(Id("isMultipart")),Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("apache")),Id("commons")),Id("fileupload")),Id("FileItemFactory")),None),[VarDec(Id("factory"),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("apache")),Id("commons")),Id("fileupload")),Id("disk")),Id("DiskFileItemFactory")),None),[],None))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("apache")),Id("commons")),Id("fileupload")),Id("servlet")),Id("ServletFileUpload")),None),[VarDec(Id("upload"),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("apache")),Id("commons")),Id("fileupload")),Id("servlet")),Id("ServletFileUpload")),None),[ExprName(Id("factory"))],None))])),Try(Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("List")),Some(TypeArgs([ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("apache")),Id("commons")),Id("fileupload")),Id("FileItem")),None)]))),[VarDec(Id("items"),CastRef(ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("List")),Some(TypeArgs([ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("apache")),Id("commons")),Id("fileupload")),Id("FileItem")),None)]))),Invoke(Method(MethodName(AmbName(Id("upload")),Id("parseRequest"))),[ExprName(Id("request"))])))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(Id("java")),Id("util")),Id("Iterator")),Some(TypeArgs([ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("apache")),Id("commons")),Id("fileupload")),Id("FileItem")),None)]))),[VarDec(Id("iter"),Invoke(Method(MethodName(AmbName(Id("items")),Id("iterator"))),[]))])),While(Invoke(Method(MethodName(AmbName(Id("iter")),Id("hasNext"))),[]),Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("apache")),Id("commons")),Id("fileupload")),Id("FileItem")),None),[VarDec(Id("item"),CastRef(ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("apache")),Id("commons")),Id("fileupload")),Id("FileItem")),None),Invoke(Method(MethodName(AmbName(Id("iter")),Id("next"))),[])))])),If(Invoke(Method(MethodName(AmbName(Id("item")),Id("isFormField"))),[]),Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("name"),Invoke(Method(MethodName(AmbName(Id("item")),Id("getFieldName"))),[]))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("value"),Invoke(Method(MethodName(AmbName(Id("item")),Id("getString"))),[]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("parammap")),Id("put"))),[ExprName(Id("name")),Invoke(Method(MethodName(Id("paramDecode"))),[ExprName(Id("request")),ExprName(Id("value"))])])),ExprStm(Invoke(Method(MethodName(Id("addToValues"))),[ExprName(Id("name")),Invoke(Method(MethodName(Id("paramDecode"))),[ExprName(Id("request")),ExprName(Id("value"))]),ExprName(Id("parammapvalues"))]))]),Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("fieldName"),Invoke(Method(MethodName(AmbName(Id("item")),Id("getFieldName"))),[]))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("fileName"),Invoke(Method(MethodName(AmbName(Id("item")),Id("getName"))),[]))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("String")),None),[VarDec(Id("contentType"),Invoke(Method(MethodName(AmbName(Id("item")),Id("getContentType"))),[]))])),LocalVarDecStm(LocalVarDec([],Boolean,[VarDec(Id("isInMemory"),Invoke(Method(MethodName(AmbName(Id("item")),Id("isInMemory"))),[]))])),LocalVarDecStm(LocalVarDec([],Long,[VarDec(Id("sizeInBytes"),Invoke(Method(MethodName(AmbName(Id("item")),Id("getSize"))),[]))])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("File")),None),[VarDec(Id("temp"),NewInstance(None,ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("File")),None),[],None))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("temp")),Id("setFileName"))),[ExprName(Id("fileName"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("temp")),Id("setContentType"))),[ExprName(Id("contentType"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("temp")),Id("setContentStream"))),[Invoke(Method(MethodName(AmbName(Id("item")),Id("getInputStream"))),[])])),LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("List")),Some(TypeArgs([ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("File")),None)]))),[VarDec(Id("files"),Invoke(Method(MethodName(AmbName(Id("fileUploads")),Id("get"))),[ExprName(Id("fieldName"))]))])),If(Eq(ExprName(Id("files")),Lit(Null)),Block([ExprStm(Assign(ExprName(Id("files")),NewInstance(None,ClassOrInterfaceType(TypeName(Id("ArrayList")),Some(TypeArgs([ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("File")),None)]))),[],None))),ExprStm(Invoke(Method(MethodName(AmbName(Id("fileUploads")),Id("put"))),[ExprName(Id("fieldName")),ExprName(Id("files"))]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("files")),Id("add"))),[ExprName(Id("temp"))]))]))]))]),[Catch(Param([],ClassOrInterfaceType(TypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(PackageOrTypeName(Id("org")),Id("apache")),Id("commons")),Id("fileupload")),Id("FileUploadException")),None),Id("ex")),Block([ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Lit(String([Chars("exception occured in file upload handling DispatchServlet")]))])),ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Lit(String([Chars("EXCEPTION")])),ExprName(Id("ex"))]))]))])])),If(Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("BuildProperties")),Id("isRequestLoggingEnabled"))),[]),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("requestLogEntry")),Id("setRequestedURLNoEventsOrValidation"))),[Invoke(Method(Invoke(Method(MethodName(AmbName(Id("request")),Id("getRequestURL"))),[]),None,Id("toString")),[])])),ExprStm(Invoke(Method(MethodName(AmbName(Id("requestLogEntry")),Id("setNameNoEventsOrValidation"))),[ExprName(Id("requested"))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("requestLogEntry")),Id("setClientIPNoEventsOrValidation"))),[Invoke(Method(MethodName(AmbName(Id("request")),Id("getRemoteAddr"))),[])])),ExprStm(Invoke(Method(MethodName(AmbName(Id("requestLogEntry")),Id("setClientPortNoEventsOrValidation"))),[Invoke(Method(MethodName(AmbName(Id("request")),Id("getRemotePort"))),[])])),If(Field(This,Id("isPostRequest")),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("requestLogEntry")),Id("setMethodNoEventsOrValidation"))),[Lit(String([Chars("POST")]))]))]),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("requestLogEntry")),Id("setMethodNoEventsOrValidation"))),[Lit(String([Chars("GET")]))]))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("requestLogEntry")),Id("setUserAgentNoEventsOrValidation"))),[Invoke(Method(MethodName(AmbName(Id("request")),Id("getHeader"))),[Lit(String([Chars("User-Agent")]))])])),ExprStm(Invoke(Method(MethodName(AmbName(Id("requestLogEntry")),Id("setRefererNoEventsOrValidation"))),[Invoke(Method(MethodName(AmbName(Id("request")),Id("getHeader"))),[Lit(String([Chars("Referer")]))])]))])),ExprStm(Assign(ExprName(Id("showerrorpage")),Not(Invoke(Method(MethodName(Id("handlePage"))),[]))))]),[Catch(Param([],ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("TooFewArgumentsException")),None),Id("ex")),Block([ExprStm(Assign(ExprName(Id("showerrorpage")),Lit(Bool(True))))])),Catch(Param([],ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("AjaxWithGetRequestException")),None),Id("ex")),Block([ExprStm(Assign(ExprName(Id("showerrorpage")),Lit(Bool(True))))])),Catch(Param([],ClassOrInterfaceType(TypeName(PackageOrTypeName(Id("utils")),Id("MultipleValidationExceptions")),None),Id("ex")),Block([ExprStm(Assign(ExprName(Id("showvalidationerror")),Lit(Bool(True)))),ExprStm(Assign(ExprName(Id("validationExceptions")),ExprName(Id("ex"))))])),Catch(Param([],ClassOrInterfaceType(TypeName(Id("Exception")),None),Id("ex")),Block([ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Plus(Lit(String([Chars("Exception in dispatch servlet: ")])),Invoke(Method(MethodName(AmbName(Id("ex")),Id("getMessage"))),[]))])),ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Lit(String([Chars("EXCEPTION")])),ExprName(Id("ex"))])),ExprStm(Assign(ExprName(Id("showerrorpage")),Lit(Bool(True))))]))]),If(ExprName(Id("showerrorpage")),Block([If(Eq(Invoke(Method(MethodName(AmbName(Id("parammap")),Id("get"))),[Lit(String([Chars("__ajax_runtime_request__")]))]),Lit(Null)),Block([ExprStm(Assign(ExprName(Id("pc")),Invoke(Method(Invoke(Method(MethodName(AmbName(Id("pages")),Id("get"))),[Lit(String([Chars("pagenotfound")]))]),None,Id("getPageClass")),[]))),ExprStm(Assign(ExprName(Id("disablePageCache")),Lit(Bool(True)))),If(Not(Invoke(Method(MethodName(Id("handlePage"))),[])),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("response")),Id("setStatus"))),[Lit(Deci("404"))])),ExprStm(Invoke(Method(Invoke(Method(MethodName(AmbName(Id("response")),Id("getWriter"))),[]),None,Id("write")),[Lit(String([Chars("<h3>404 Not Found</h3>")]))]))]))]))]),If(ExprName(Id("showvalidationerror")),Block([If(Eq(Invoke(Method(MethodName(AmbName(Id("parammap")),Id("get"))),[Lit(String([Chars("__ajax_runtime_request__")]))]),Lit(Null)),Block([ExprStm(Invoke(Method(MethodName(AmbName(Id("response")),Id("setStatus"))),[Lit(Deci("500"))])),ExprStm(Invoke(Method(Invoke(Method(MethodName(AmbName(Id("response")),Id("getWriter"))),[]),None,Id("write")),[Invoke(Method(MethodName(AmbName(AmbName(Id("utils")),Id("ValidationErrorPopupCreator")),Id("getErrorPopup"))),[ExprName(Id("validationExceptions"))])]))]))]))),ExprStm(Invoke(Method(MethodName(Id("cleanupThreadLocals"))),[]))])),FieldDec([Private],Boolean,[VarDec(Id("disablePageCache"),Lit(Bool(False)))]),MethodDec(MethodDecHead([Private],None,Boolean,Id("handlePage"),[],None),Block([If(NotEq(ExprName(Id("pc")),Lit(Null)),Block([Try(Block([LocalVarDecStm(LocalVarDec([],ClassOrInterfaceType(TypeName(Id("PageServlet")),None),[VarDec(Id("pageservlet"),CastRef(ClassOrInterfaceType(TypeName(Id("PageServlet")),None),Invoke(Method(MethodName(AmbName(Id("pc")),Id("newInstance"))),[])))])),If(ExprName(Id("disablePageCache")),Block([ExprStm(Assign(ExprName(AmbName(Id("pageservlet")),Id("isPageCacheDisabled")),Lit(Bool(True))))])),ExprStm(Invoke(Method(MethodName(AmbName(Id("pageservlet")),Id("serve"))),[ExprName(Id("request")),ExprName(Id("response")),ExprName(Id("parammap")),ExprName(Id("parammapvalues")),ExprName(Id("fileUploads"))])),If(NotEq(Invoke(Method(MethodName(AmbName(Id("parammap")),Id("get"))),[Lit(String([Chars("show_build_id")]))]),Lit(Null)),Block([Try(Block([ExprStm(Invoke(Method(Invoke(Method(MethodName(AmbName(Id("response")),Id("getWriter"))),[]),None,Id("write")),[Plus(Lit(String([Chars("build-id:")])),Lit(String([Chars("846eefaa-3908-459a-b21d-c4be68e9d975")])))]))]),[Catch(Param([],ClassOrInterfaceType(TypeName(Id("IOException")),None),Id("ioe")),Block([ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Lit(String([Chars("EXCEPTION")])),ExprName(Id("ioe"))]))]))])]))]),[Catch(Param([],ClassOrInterfaceType(TypeName(Id("IllegalAccessException")),None),Id("iae")),Block([ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Plus(Lit(String([Chars("Problem in dispatch servlet page lookup: ")])),Invoke(Method(MethodName(AmbName(Id("iae")),Id("getMessage"))),[]))])),ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Lit(String([Chars("EXCEPTION")])),ExprName(Id("iae"))])),Return(Some(Lit(Bool(False))))])),Catch(Param([],ClassOrInterfaceType(TypeName(Id("InstantiationException")),None),Id("ie")),Block([ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Plus(Lit(String([Chars("Problem in dispatch servlet page lookup: ")])),Invoke(Method(MethodName(AmbName(Id("ie")),Id("getMessage"))),[]))])),ExprStm(Invoke(Method(MethodName(AmbName(AmbName(AmbName(AmbName(Id("org")),Id("webdsl")),Id("logging")),Id("Logger")),Id("error"))),[Lit(String([Chars("EXCEPTION")])),ExprName(Id("ie"))])),Return(Some(Lit(Bool(False))))])),Catch(Param([],ClassOrInterfaceType(TypeName(Id("MultipleValidationExceptions")),None),Id("mve")),Block([Throw(ExprName(Id("mve")))])),Catch(Param([],ClassOrInterfaceType(TypeName(Id("RuntimeException")),None),Id("re")),Block([Return(Some(Lit(Bool(False))))]))])]),Block([Return(Some(Lit(Bool(False))))])),Return(Some(Lit(Bool(True))))]))]))])))